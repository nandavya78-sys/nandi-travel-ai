<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Nandi Travel AI</title>

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
  background: #0f172a;
  color: #e5e7eb;
  height: 100vh;
  display: flex;
  flex-direction: column;
}

/* Chat area */
#chat {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
}

/* Message bubbles */
.msg {
  max-width: 70%;
  padding: 12px 16px;
  margin-bottom: 14px;
  border-radius: 14px;
  line-height: 1.4;
}

.bot {
  background: #1e293b;
  align-self: flex-start;
}

.user {
  background: #2563eb;
  align-self: flex-end;
}

/* Input bar */
#inputBar {
  display: flex;
  padding: 12px;
  background: #020617;
  border-top: 1px solid #1e293b;
}

#plus {
  width: 40px;
  font-size: 20px;
  margin-right: 8px;
}

#text {
  flex: 1;
  padding: 10px;
  border-radius: 8px;
  border: none;
  font-size: 16px;
}

#send {
  margin-left: 8px;
  padding: 10px 14px;
}

/* Floating menu */
#menu {
  position: absolute;
  bottom: 70px;
  left: 20px;
  background: #020617;
  border: 1px solid #1e293b;
  border-radius: 10px;
  display: none;
}

#menu button {
  display: block;
  width: 100%;
  padding: 10px 16px;
  background: none;
  border: none;
  color: #e5e7eb;
  text-align: left;
}

#menu button:hover {
  background: #1e293b;
}

/* Cards */
.card {
  background: #020617;
  border: 1px solid #1e293b;
  border-radius: 12px;
  padding: 14px;
  margin-top: 12px;
}
</style>
</head>

<body>

<div id="chat">
  <div class="msg bot">
    üëã Hi! I‚Äôm <b>Nandi Travel AI</b>.<br>
    Click <b>+</b> to search Flights or Hotels.
  </div>
</div>

<div id="menu">
  <button onclick="startFlights()">‚úà Flights</button>
  <button onclick="startHotels()">üè® Hotels</button>
</div>

<div id="inputBar">
  <button id="plus" onclick="toggleMenu()">+</button>
  <input id="text" placeholder="Ask anything‚Ä¶" />
  <button id="send" onclick="sendMsg()">Send</button>
</div>

<script>
const chat = document.getElementById("chat");
const menu = document.getElementById("menu");

function addMsg(text, who) {
  const div = document.createElement("div");
  div.className = "msg " + who;
  div.innerHTML = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function toggleMenu() {
  menu.style.display = menu.style.display === "block" ? "none" : "block";
}

function sendMsg() {
  const t = document.getElementById("text");
  if (!t.value) return;
  addMsg(t.value, "user");
  addMsg("Use + to search flights or hotels.", "bot");
  t.value = "";
}

/* ---------- Flights flow ---------- */
function startFlights() {
  menu.style.display = "none";
  addMsg(`
    <b>Flight search</b><br><br>
    From: <input id="from"><br><br>
    To: <input id="to"><br><br>
    Date: <input type="date" id="fdate"><br><br>
    <button onclick="loadFlights()">Search Flights</button>
  `, "bot");
}

async function loadFlights() {
  const res = await fetch("/flight");
  const data = await res.json();

  data.forEach(f => {
    addMsg(`
      <div class="card">
        ‚úà <b>${f.airline}</b><br>
        ${f.route}<br>
        ${f.stops}<br>
        üí∞ ${f.price}
      </div>
    `, "bot");
  });
}

/* ---------- Hotels flow ---------- */
function startHotels() {
  menu.style.display = "none";
  addMsg(`
    <b>Hotel search</b><br><br>
    City: <input id="city"><br><br>
    Check-in: <input type="date"><br>
    Check-out: <input type="date"><br><br>
    <button onclick="loadHotels()">Search Hotels</button>
  `, "bot");
}

async function loadHotels() {
  const res = await fetch("/hotel");
  const data = await res.json();

  data.forEach(h => {
    addMsg(`
      <div class="card">
        üè® <b>${h.name}</b><br>
        ‚≠ê ${h.stars}<br>
        üìç ${h.distance}<br>
        üí∞ ${h.price}
      </div>
    `, "bot");
  });
}
</script>

</body>
</html>
